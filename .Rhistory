ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0, stat = "count") +
coord_flip()
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
ggplot(aes(x = factor(class), y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0, stat = "count") +
coord_flip()
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count)
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
ggplot(aes(x = factor(class), y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0, stat = "count") +
coord_flip()
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count)
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
ggplot(aes(x = factor(class), y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0)
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
ggplot(aes(x = factor(class), y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
coord_flip()
table(repeats$class) %>%
tidy()
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
mutate(class = factor(as.character(class))) %>%
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
coord_flip()
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count)
a <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
mutate(class = factor(as.character(class)))
a$class
a
as.character(a$class)
factor(as.character(a$class))
as.factor(as.character(a$class))
a?factor
?factor
table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
mutate(class = factor(class, levels = class)) %>%
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
coord_flip()
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
arrange(count) %>%
mutate(class = factor(class, levels = class)) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
coord_flip() +
labs(title = "Classes d'éléments répétés", y = "Classe", x = "Nombre d'éléments")
barplotClass
repeats
repeats %>%
mutate(width = end - start) %>%
summary
repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = class, y = total_length)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueure cumulée") +
coord_flip()
repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length)
repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = class, y = total_length)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueure cumulée") +
coord_flip()
repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class), y = total_length)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueure cumulée") +
coord_flip()
repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = class), y = total_length)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueure cumulée") +
coord_flip()
knitr::opts_chunk$set(echo = TRUE)
setwd("F:/divers/moi/Bioinfo-fr/repeats")
compiler::enableJIT(3)
compiler::setCompilerOptions(suppressAll = TRUE)
library(purrr) # programation fonctionelle
library(readr) # import de fichier txt
library(cowplot) # charge ggplot2
library(rtracklayer) # importe les gtf
library(broom) # nettoie les sorties sales de R
library(dplyr) # manipulation de tableaux de données
# téléchargé depuis le UCSC table browser, all field, 2017-04-04
# prends trois plombes a charger...
repeats_dirty <- read_tsv("repeats_rmsk_hg38.txt.gz")
repeats <- select(repeats_dirty, genoName, genoStart, genoEnd, strand, repName, repClass, repFamily) %>%
dplyr::rename(chr = genoName, start = genoStart, end = genoEnd, name = repName, class = repClass, family = repFamily) %>%
filter(chr %in% c(paste0("chr", 1:22), "chrX", "chrY"))
table(repeats$chr) # il ne reste que des chr standard
length(unique(repeats$family)) # 60
length(unique(repeats$class)) # 20
class_order <- table(repeats$class) %>%
sort(decreasing = TRUE) %>%
names
class_order
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
mutate(class = factor(class, levels = class_order)) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
coord_flip()
barplotClass
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
mutate(class = factor(class, levels = rev(class_order))) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
coord_flip()
barplotClass
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée") +
coord_flip()
genomePropPlot
chr_length <- read_tsv("http://hgdownload-test.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.chrom.sizes", col_names = FALSE) %>%
dplyr::rename(seqnames = X1, length = X2) %>%
filter(seqnames %in% c(paste0("chr", 1:22), "chrX", "chrY", "chrM")) %>%
mutate(seqnames = factor(seqnames, levels = c(paste0("chr", 1:22), "chrX", "chrY"))
)
chr_length <- read_tsv("http://hgdownload-test.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.chrom.sizes", col_names = FALSE) %>%
dplyr::rename(seqnames = X1, length = X2) %>%
filter(seqnames %in% c(paste0("chr", 1:22), "chrX", "chrY", "chrM")) %>%
mutate(seqnames = factor(seqnames, levels = c(paste0("chr", 1:22), "chrX", "chrY", "chrM")))
chr_length
sessionInfo()
install.packages(ggplot2)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
knitr::opts_chunk$set(echo = TRUE)
setwd("F:/divers/moi/Bioinfo-fr/repeats")
compiler::enableJIT(3)
compiler::setCompilerOptions(suppressAll = TRUE)
library(cowplot) # charge ggplot2
library(ggplot2)
install.packages("ggplot2")
library(cowplot)
sessionInfo()
knitr::opts_chunk$set(echo = TRUE)
setwd("F:/divers/moi/Bioinfo-fr/repeats")
compiler::enableJIT(3)
compiler::setCompilerOptions(suppressAll = TRUE)
library(purrr) # programation fonctionelle
library(readr) # import de fichier txt
library(cowplot) # charge ggplot2
library(rtracklayer) # importe les gtf
library(broom) # nettoie les sorties sales de R
library(dplyr) # manipulation de tableaux de données
# téléchargé depuis le UCSC table browser, all field, 2017-04-04
# prends trois plombes a charger...
repeats_dirty <- read_tsv("repeats_rmsk_hg38.txt.gz")
repeats <- select(repeats_dirty, genoName, genoStart, genoEnd, strand, repName, repClass, repFamily) %>%
dplyr::rename(chr = genoName, start = genoStart, end = genoEnd, name = repName, class = repClass, family = repFamily) %>%
filter(chr %in% c(paste0("chr", 1:22), "chrX", "chrY"))
table(repeats$chr) # il ne reste que des chr standard
length(unique(repeats$family)) # 60
length(unique(repeats$class)) # 20
class_order <- table(repeats$class) %>%
sort(decreasing = TRUE) %>%
names
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
mutate(class = factor(class, levels = rev(class_order))) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
coord_flip()
chr_length <- read_tsv("http://hgdownload-test.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.chrom.sizes", col_names = FALSE) %>%
dplyr::rename(seqnames = X1, length = X2) %>%
filter(seqnames %in% c(paste0("chr", 1:22), "chrX", "chrY", "chrM")) %>%
mutate(seqnames = factor(seqnames, levels = c(paste0("chr", 1:22), "chrX", "chrY")))
chr_length
genome_length <- sum(chr_length$length)
genome_length <- sum(as.numeric(chr_length$length))
genome_length
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée") +
scale_y_continuous(sec.axis = sec_axis(~100*./genome_length, name = "% du génome"))
coord_flip()
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = total_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée") +
scale_y_continuous(sec.axis = sec_axis(~100*./genome_length, name = "% du génome")) +
coord_flip()
genomePropPlot
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = 100 * total_length / genome_length), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée (pb)") +
scale_y_continuous(sec.axis = sec_axis(~100*./genome_length, name = "% du génome")) +
coord_flip()
genomePropPlot
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = paste0(round(100 * total_length / genome_length, digits = 1)), "%"), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée (pb)") +
scale_y_continuous(sec.axis = sec_axis(~100 * . / genome_length, name = "% du génome")) +
coord_flip()
genomePropPlot
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = paste0(round(100 * total_length / genome_length, digits = 1), "%"), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée (pb)") +
scale_y_continuous(sec.axis = sec_axis(~100 * . / genome_length, name = "% du génome")) +
coord_flip()
genomePropPlot
genomePropPlot <- repeats %>%
mutate(width = end - start) %>%
group_by(class) %>%
summarise(total_length = sum(width)) %>%
arrange(total_length) %>%
ggplot(aes(x = factor(class, levels = rev(class_order)), y = total_length)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = paste0(round(100 * total_length / genome_length, digits = 1), "%")), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Longueur cumulée (pb)") +
scale_y_continuous(sec.axis = sec_axis(~100 * . / genome_length, name = "% du génome")) +
coord_flip()
genomePropPlot
barplotClass
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
mutate(class = factor(class, levels = rev(class_order))) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
scale_y_continuous(sec.axis =_axis()) +
barplotClass <- table(repeats$class) %>%
tidy() %>%
dplyr::rename(class = Var1, count = Freq) %>%
mutate(class = factor(class, levels = rev(class_order))) %>% # reordering for the plot
ggplot(aes(x = class, y = count)) +
geom_bar(stat = "identity", fill = "darkorange") +
geom_text(aes(label = count), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
scale_y_continuous(sec.axis = dup_axis()) +
coord_flip()
barplotClass
knitr::opts_chunk$set(echo = TRUE)
setwd("F:/divers/moi/Bioinfo-fr/repeats")
compiler::enableJIT(3)
compiler::setCompilerOptions(suppressAll = TRUE)
install.packages("forcats")
library(purrr) # programation fonctionelle
library(readr) # import de fichier txt
library(cowplot) # charge ggplot2
library(rtracklayer) # importe les gtf
library(broom) # nettoie les sorties sales de R
library(dplyr) # manipulation de tableaux de données
library(forcats)
# téléchargé depuis le UCSC table browser, all field, 2017-04-04
# prends trois plombes a charger...
repeats_dirty <- read_tsv("repeats_rmsk_hg38.txt.gz")
repeats <- select(repeats_dirty, genoName, genoStart, genoEnd, strand, repName, repClass, repFamily) %>%
dplyr::rename(chr = genoName, start = genoStart, end = genoEnd, name = repName, class = repClass, family = repFamily) %>%
filter(chr %in% c(paste0("chr", 1:22), "chrX", "chrY"))
table(repeats$chr) # il ne reste que des chr standard
length(unique(repeats$family)) # 60
length(unique(repeats$class)) # 20
getwd()
setwd("F:/divers/moi/Bioinfo-fr/repeats")
getwd()
save(repeats, file = "repeats.RData")
?fct_infreq
repeats <- mutate(repeats, class = fct_infreq(factor(class)))
ggplot(repeats, aes(x = class)) +
geom_bar(stat = "count", fill = "darkorange") +
geom_text(aes(label = ..count..), y = 10000, hjust = 0) +
labs(title = "Classes d'éléments répétés", x = "Classe", y = "Nombre d'éléments") +
scale_y_continuous(sec.axis = dup_axis()) +
coord_flip()
ggplot(repeats, aes(x = class)) +
geom_bar(stat = "count", fill = "darkorange")
ggplot(repeats, aes(x = class)) +
geom_bar(stat = "count", fill = "darkorange") +
geom_text(aes(label = ..count..), y = 10000, hjust = 0)
ggplot(repeats, aes(x = class)) +
geom_bar(stat = "count", fill = "darkorange")
ggplot(repeats, aes(x = class)) +
geom_bar(stat = "count", fill = "darkorange") +
geom_text(aes(label = ..count..), y = 10000, hjust = 0)
head(repeats$class)
1
?system
26 586 / 12
26586 / 12
30+
200+
300
30+
200+
300+
4000+
600+
60+
30+
90+
300+
200+
100+
300+
40+
30+
100+
200+
20+
100+
20+
30+
60+
600+
300+
50+
150+
30+
100+
100+
400+
1000+
400+
1000+
100+
500+
200+
100+
400+
200+
100+
200+
300+
300+
300+
200+
50+
20+
50+
300+
150+
400+
100+
100+
200+
20+
30+
50+
20+
300+
50+
10+
40+
150+
10+
150+
10+
50+
50+
10+
20+
80+
1200+
150+
70+
1000+
300+
50+
1000+
400+
200
setwd("F:/divers/moi/Roslin/scpackage/scfilters")
library(testthat)
library(devtools)
library(dplyr)
library(ggplot2)
library(roxygen2)
load_all()
test()
myData <- data_frame(
bin = rep(c(1, 2, 3), each = 3),
mean = 9:1,
sd = runif(9),
cv = runif(9),
cell1 = 8:0 + runif(9),
cell2 = 8:0 + runif(9)
)
myData
filter_expression_table(myData, bin_cutoff = 2)
filter_expression_table(myData, bin_cutoff = 3)
myData(1:3, c("cell1", "cell2"))
myData[1:3, c("cell1", "cell2")]
test()
roxygenise()
source('F:/divers/moi/Roslin/scpackage/scfilters/R/all_calls.R', echo=TRUE)
?get_mean_median
load()
load_all()
load_all()
load_all()
scFeatureFilter(scData_hESC)
scFeatureFilter(scData_hESC)
load_all()
scFeatureFilter(scData_hESC)
scFeatureFilter(scData_hESC, print_plots = TRUE)
